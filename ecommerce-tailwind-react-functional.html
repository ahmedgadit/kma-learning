<html>
  <head>
    <title>Class work | Home Work | test server change</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="js/react-dev.js"></script>
    <script src="js/react-dom.js"></script>
    <script src="tailwindcss.js"></script>
    <!-- Assignment react todo app through cdn using redux, redux state management tool it stores your data in localstorage-->
    <!-- Reference Link mentioned below -->
    <!-- https://gist.github.com/erspark2002/0ea49cc782049df5f3de271ba9ff41e1 -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              blue: {
                DEFAULT: "#353887",
                50: "#9C9ED8",
                100: "#8D90D2",
                200: "#7073C7",
                300: "#5256BB",
                400: "#4144A4",
                500: "#353887",
                600: "#25275F",
                700: "#151736",
                800: "#06060E",
                900: "#000000",
                950: "#000000",
              },
              red: {
                DEFAULT: "#CF2E39",
                50: "#FEFBFB",
                100: "#F9E4E6",
                200: "#EFB6BA",
                300: "#E5898F",
                400: "#DA5B63",
                500: "#CF2E39",
                600: "#A9262F",
                700: "#841D24",
                800: "#5E151A",
                900: "#390D10",
                950: "#26080A",
              },
              white: {
                DEFAULT: "#E8E8E8",
                50: "#FFFFFF",
                100: "#FCFCFC",
                200: "#F7F7F7",
                300: "#F2F2F2",
                400: "#EDEDED",
                500: "#E8E8E8",
                600: "#CCCCCC",
                700: "#B0B0B0",
                800: "#949494",
                900: "#787878",
                950: "#6A6A6A",
              },
              black: {
                DEFAULT: "#0F0F0F",
                50: "#6B6B6B",
                100: "#616161",
                200: "#4D4D4D",
                300: "#383838",
                400: "#242424",
                500: "#0F0F0F",
                600: "#0A0A0A",
                700: "#050505",
                800: "#000000",
                900: "#000000",
                950: "#000000",
              },
              seaGreen: {
                DEFAULT: "#31A24C",
                50: "#A6E4B5",
                100: "#97DFA8",
                200: "#77D68E",
                300: "#58CD74",
                400: "#3AC15B",
                500: "#31A24C",
                600: "#247738",
                700: "#174C24",
                800: "#0A210F",
                900: "#000000",
                950: "#000000",
              },
            },
          },
        },
      };
    </script>
  </head>

  <body className="bg-white-50 flex flex-col text-blue-900 h-svh">
    <div id="AppComponent"></div>
  </body>
  <script
    src="https://unpkg.com/@babel/standalone@7.10.3/babel.min.js"
    crossorigin
  ></script>
  <script type="text/babel" data-presets="react,stage-3">
     // Define a React functional component
     const Example = () => {
      const [count, setCount] = React.useState(0);
      React.useEffect(() => {
        document.title = `You clicked ${count} times`;
      });
      return (
        <div>
          <p>You clicked {count} times</p>
          <button onClick={() => setCount(count + 1)}>
            Click me
          </button>
        </div>
      );
    };

    // style becomes object, its not a string anymore, if it is string your application will not render
    // example
    // <div style='width:30px; heigh:30px'> this will not render in react
    // <div style={{'width':30px, 'flexDirection':30px}}

    // class becomes className, it will remain string
    //example
    // <div class="px-2 py-2 w-10"> this will not render
    // <div className="px-2 py-2 w-10">

    const PriceBox = ({price, discounted_price}) => {
      const calculatePrice = discounted_price < price;
      if(calculatePrice) {
        return (
          <div className="text-seaGreen-500">
              <span className="text-red-600 line-through">{ price }</span>
              { discounted_price }
          </div>
        )
      }
      return (
        <div className="text-seaGreen-500">{ price }</div>
      )
    }


    const ProductBox = ({ product, checkoutForm, updateCart, products, ...rest}) => {
      const addToCart = (product) => {
        var currentProduct = products.find((x) => {
          return x.id == product;
        });
        var currentQty =
          document.getElementById("qty" + product).value == "" ||
          document.getElementById("qty" + product).value == null
            ? 1
            : document.getElementById("qty" + product).value;
        cartExistIndex = checkoutForm.cart_details.findIndex((x) => {
          return x.id == product;
        });
        if (cartExistIndex != -1) {
          checkoutForm.cart_details[cartExistIndex].quantity +=
            parseInt(currentQty);
        } else {
          var cartItem = {
            ...currentProduct,
            quantity: currentQty,
          };

          checkoutForm.cart_details.push(cartItem);
        }
        updateCart(checkoutForm.cart_details);
        document.getElementById("qty" + product).value = "";
      }

      return (
        <div className="bg-white-500 text-black-500 p-4 rounded-md shadow-2xl slideDown">
          <h1 className="font-bold">{ product.name }</h1>
          <p className="font-medium">{ product.description }</p>
          <PriceBox price={product.price} discounted_price={product.discounted_price} />
          <div className="">
            <input type="number" id={"qty"+ product.id} />
            <button
                className="bg-blue-400 text-white-200 font-medium rounded-lg w-32 py-1"
                onClick={()=>{ addToCart(product.id) }}
            >
                Add to Cart
            </button>
          </div>
        </div>
      )
    }

    const CartBox = ({name, price, discounted_price, quantity, ...cartDetail}) => {



      return (
        <div className="box bg-red-50 font-medium text-blue-900">
          <div style={{
            "padding-left":"10px", 'border-radius': '50%', 'padding-right': '10px', 'display':'flex', 'justify-content': 'space-between', 'align-items': 'center'
          }}>
              <p >{name}</p>
              <PriceBox price={price} discounted_price={discounted_price}/>
            <div>
                Quantity {quantity}
            </div>
            <div>
                <button className="text-red-500" >
                    X
                </button>
            </div>
          </div>
        </div>
      )
    }

    const ProductList = ({ updateCart, checkoutForm }) => {
      const [checkFormVal, setCheckFormVal] = React.useState(checkoutForm);
        const products = [
            {
                id: 1,
                name: 'water bottle',
                description: 'color: blue size: large',
                price: 100,
                discounted_price: 99,
            },
            {
                id: 2,
                name: 'mouse',
                description: 'wired usb port',
                price: 250,
                discounted_price: 199,
            },
            {
                id: 3,
                name: 'watch',
                description: 'color: black, watch type: smart, brand: apple',
                price: 5000,
                discounted_price: 4999,
            },
            {
                id: 4,
                name: 'infinix s23',
                description: 'color blue, storage: 120gb ram: 2gb display: 6x4',
                price: 25000,
                discounted_price: 24999,
            },
            {
                id: 5,
                name: 'shoes',
                description: 'size: 8, color blue, type: sports wear',
                price: 3000,
                discounted_price: 3000,
            },
        ];


        return (
            <>
            {
                products.map((x, index) => {
                    return (
                      <ProductBox key={index} products={products} product={x} checkoutForm={checkoutForm} updateCart={(cart)=>{ updateCart(cart) }} arrayIndex={index} style="" id=""/>
                     )
                })
            }
            </>
        )
    }

    const CartList = ({cart}) => {
      return (
        <div id="boxList" style={{ width: "80%", display: "flex", flexDirection: "column", gap: "4px" }}
          className="grid-item slideDown">
          {
            cart.map((x) => {
              return (
                <CartBox cartDetail={x} />
              )
            })
          }
        </div>
      )
    }

    const Application = () => {

        const [message, setMessage] = React.useState('Hello React!');
        const [cart, setCart] = React.useState([]);
        const initialCheckoutForm = {
          first_name: "",
          last_name: "",
          phone_number: 0,
          address: "",
          email: "",
          postal_code: "",
          city: "",
          country: "",
          payment_method: "",
          shipping_details: {
            address: "",
            city: "",
            postal_code: "",
            country: "",
            phone_number: "",
            reciever_name: "",
          },
          total_amount: "",
          cart_details: [],
        };
        const [checkoutForm, setCheckoutForm] = React.useState(initialCheckoutForm);
       
        let newMesg = "This is Let";
        const changeMessageValue = (newVal) => {
            setMessage(newVal);
            newMesg = "This has been changed also";
        }

        const updateCart = (cart) => {
          setCheckoutForm((prev) => {
            const newObject = {...prev}
            newObject.cart_details = cart;

            return newObject;
          })
        }

        React.useEffect(()=> {
          debugger;
          setCart(checkoutForm.cart_details)
        },[checkoutForm.cart_details])

        return (
            <>
                <div className="bg-red-50 p-8">
                    <h1 className="text-blue-500 text-6xl"> { message }</h1>
                    <h1 className="text-blue-500 text-6xl"> { newMesg }</h1>
                    <button onClick={()=>{ changeMessageValue("This has been Changed") }}>
                        Change me please!
                    </button>
                </div>
                <div id='container' className="flex grow flex-column">
                    <div className="w-72 box-border p-8 bg-red-100">
                        <h1 className="text-blue-400 text-2xl">Sidebar</h1>
                    </div>
                    <div id='mainBox' className="flex w-full gap-4">
                        <div className='bg-white-500 text-black-500 p-4 rounded-md shadow-2xl slideDown' style={{width: '30%'}}>
                            <form id='ecommerceForm'
                                style={{ display: "flex", "flexDirection":"column", gap: "4px" }}>
                                <label>Checkout Form</label>
                                <input type='text' name='first_name' required id='first_name' placeholder="Enter you first_name" />
                                <span style={{color: 'red'}} hidden id='taskErrorField-first_name'>This field is required</span>
                                <input type='text' name='last_name' required id='last_name' placeholder="Enter you last_name" />
                                <span style={{color: 'red'}} hidden id='taskErrorField-last_name'>This field is required</span>
                                <input type='tel' name='number' required id='number' placeholder="Enter you phone_number" />
                                <span style={{color: 'red'}} hidden id='taskErrorField-number'>This field is required</span>
                                <textarea id="address" name="address" placeholder="enter your full address"></textarea>
                                <span style={{color: 'red'}} hidden id='taskErrorField-address'>This field is required</span>
                                <input type='email' name='email' required id='email' placeholder="Enter you email" />
                                <span style={{color: 'red'}} hidden id='taskErrorField-email'>This field is required</span>
                                <input type='text' name='postal_code' required id='postal_code'
                                    placeholder="Enter you postal_code" />
                                <span style={{color: 'red'}} hidden id='taskErrorField-postal_code'>This field is required</span>
                                <select id="city" name="city" defaultValue="Karachi">
                                    <option>Karachi</option>
                                    <option>Lahore</option>
                                    <option>Islamabed</option>
                                    <option>Peshawar</option>
                                    <option>Queta</option>
                                </select>
                                <span style={{color: 'red'}} hidden id='taskErrorField-city'>This field is required</span>
                                <select id="country" name="country" defaultValue="Pakistan">
                                    <option>Pakistan</option>
                                </select>
                                <span style={{color: 'red'}} hidden id='taskErrorField-country'>This field is required</span>
                                <div>
                                    <label className="flex gap-2 blue-700">
                                        <input type='radio' name='task' required id='payment_method' defaultChecked={true}
                                            placeholder="Enter you payment_method" />
                                        Cash on Delivery
                                    </label>
                                    <label className="flex gap-2">
                                        <input type='radio' name='task' required id='payment_method'
                                            placeholder="Enter you payment_method" />
                                        Online Payment
                                    </label>
                                </div>
                                <button type='button'  id='submitBtn' className='bg-blue-600 text-white-200 p-2 border-0 hover:bg-blue-700 active:bg-blue-700 rounded-md'>Checkout</button>
                            </form>
                            <div>
                                <label>Cart Details</label>
                                <CartList cart={cart}/>
                            </div>
                        </div>
                        <div id='main' className="p-4 grid grow border-box grid-cols-2 gap-4">
                            <ProductList updateCart={(cart) => { updateCart(cart) }} checkoutForm={checkoutForm}/>
                        </div>
                    </div>
                </div>
            </>
        )
    }

    const root = ReactDOM.createRoot(document.getElementById("AppComponent"))
    root.render(<Application />);
  </script>
</html>
